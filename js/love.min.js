function onNavigation(a) {
    2 == a.progress && player.pause()
}
Flowtime.showProgress(!0), Flowtime.addEventListener("flowtimenavigation", onNavigation, !1), Flowtime.start(), $(function () {
    $(".nojavascript").remove(), setInterval(function () {
        $(".showtip").removeClass("showtip").hide().siblings("span").addClass("showtip").fadeIn()
    }, 5e3), $("#write-submit").click(function () {
        for (var a = {}, b = 1; 79 > b; b++) a[b] = $("#text-" + b).text();
        $(".write-ok").fadeIn(), $("#text-href").focus(), $("#back").click(function () {
            $(".write-ok").fadeOut()
        }), $("#write-post").click(function () {
            var b = $("#text-href").text(),
                c = $("#text-music").text();
            "" == b.replace(/\s+/g, "") ? ($("#write-url i").text("←不能为空").fadeIn(), $("#text-href").focus(), setTimeout(function () {
                $("#write-url i").fadeOut()
            }, 3e3)) : /^[\w\-]{3,30}$/.test(b) ? "" == c.replace(/\s+/g, "") ? ($("#write-mp3 i").text("←不能为空").fadeIn(), $("#text-music").focus(), setTimeout(function () {
                $("#write-mp3 i").fadeOut()
            }, 3e3)) : /^(http|https):\/\/+([\w-]+\.)+[\w-]+(\/[\w-.\/?%&=]*)?$/.test(c) ? ($("#back").html('<img src="img/loading.gif" alt="loading">'), $("#write-post").text("页面生成中...").attr("disabled", !0).addClass("disabled"), $.post("love.php?add", {
                textHref: b,
                textMusic: c,
                textArr: a
            }, function (a) {
                1 == a.status ? ($("#back").hide(), $(".write-ok p").hide(), $(".write-ok div button").hide(), $(".write-ok div h2").hide().text("成功生成表❤白页面").fadeIn(), $("#write-url").html('您的表白链接是：<a href="' + a.url + '" target="_blank">' + a.url + "</a>").fadeIn(), $(".write-share").css("display", "inline-block").children("p").show()) : 0 == a.status && ($("#write-url i").text(a.msg).fadeIn(), $("#text-href").focus(), setTimeout(function () {
                    $("#write-url i").fadeOut()
                }, 3e3), $("#back").text("重新修改"), $("#write-post").text("❤ 生成表白页面").attr("disabled", !1).removeClass("disabled"))
            }, "json")) : ($("#write-mp3 i").text("←不允许的链接").fadeIn(), $("#text-music").focus(), setTimeout(function () {
                $("#write-mp3 i").fadeOut()
            }, 3e3)) : ($("#write-url i").text("←格式不正确").fadeIn(), $("#text-href").focus(), setTimeout(function () {
                $("#write-url i").fadeOut()
            }, 3e3))
        })
    });
});